
ИНТЕГРАЦИЯ ШАБЛОНА

----------------------
Условие показа пункта меню в шаблоне (с помощью уровня доступа):

if ($arItem["PERMISSION"] > "D"):

Важно! Условия, включающие проверку значения переменной $PERMISSION, используются только для меню сайта.

----------------------
Задать условие применения шаблона к сайту:

Админ-панель > Настройки системы > Сайты > Изменить


Примеры php-условий для показа шаблона сайта:

- $USER->IsAuthorized()	Проверяется, является ли текущий пользователь авторизованным в системе.
- $USER->IsAdmin()	Проверяется, является ли текущий пользователь администратором.
- in_array('5', $USER->GetUserGroupArray())	Проверяется, относится ли текущий пользователь к указанной группе (в данном случае к группе с ID равным 5).


Условие показа шаблона по PHP выражению:

!$GLOBALS['USER']->IsAuthorized() && (!isset($_SERVER['REMOTE_USER']) || strlen($_SERVER['REMOTE_USER']) <= 0)


Задавать права доступа можно при СОЗДАНИИ или РЕДАКТИРОВАНИИ страницы или раздела.

----------------------
ШАБЛОН ДИЗАЙНА.

Все шаблоны хранятся в 
/bitrix/templates/
или, начиная с версии 14.0.0, в 
/local/templates/. 
/bitrix/templates/.default - файлы общие для всех шаблонов сайта.

Шаблон сайта обычно состоит из
- Верхней части дизайна (header);
- Рабочей области страницы (Work area);
- Нижней части дизайна (footer).

----------------------
Подключение частей дизайна.

<?
require($_SERVER["DOCUMENT_ROOT"]."/bitrix/header.php");
$APPLICATION->SetTitle("1C-Битрикс: Управление сайтом");
?>

Тело документа. Содержательная часть.

<?
require($_SERVER["DOCUMENT_ROOT"]."/bitrix/footer.php");
?>

----------------------
СТРУКТУРА ФАЙЛОВ ШАБЛОНА САЙТА.

/components – шаблоны компонентов;
/images – картинки, которые не зависят от просматриваемой страницы;
/include_areas – включаемые области;
/lang – языковые файлы;
/page_templates – шаблоны страниц и редактируемых областей;
/snippets – содержит сниппеты – маленькие фрагменты html-кода для ускорения работы контент-менеджера по созданию часто встречающихся блоков кода;
/themes – тема оформления шаблона;
header.php
footer.php
description.php – название и описание шаблона;
.styles.php – описания стилей для визуального редактора страниц;
template_styles.css – стили шаблона;
styles.css – стили для контента и включаемых областей. Эти стили можно применять в визуальном редакторе.
screen.gif - скриншот шаблона


----------------------
Шаблоны могут быть загружены в формате <имя_файла>.tar.gz. 

Комплексные компоненты должны находиться в #WORKAREA.

Если различия между шаблонами незначительны, то лучше использовать один шаблон:
- либо с внедрённой в него проверкой того, какая страница сейчас открыта,
- либо с использованием включаемых областей.

Управление шаблонами в админ-панели:
(Настройки > Настройки продукта > Сайты > Шаблоны сайтов).

РЕДАКТИРОВАТЬ ШАБЛОН можно и из публичной части сайта:
Шаблон сайта > В панели управления > Редактировать шаблон

С версии 14.0 редактирование шаблона с помощью ВИЗУАЛЬНОГО РЕДАКТОРА невозможно.

Есть возможность ЭКСПОРТИРОВАТЬ и ИМПОРТИРОВАТЬ шаблон.
При загрузке по умолчанию шаблон будет распакован и помещен в папку с именем, соответствующим имени загружаемого файла 
(/bitrix/templates/<идентификатор_шаблона>/). 
Для того чтобы шаблону был присвоен другой идентификатор, а сам шаблон был размещён в папке с соответствующим именем, в поле Код шаблона указывается нужный код шаблона.

На время создания шаблона рекомендуется отключить кеширование.

Список доступных шаблонов страниц и редактируемых областей создается с помощью файла 
/<идентификатор_шаблона>/page_templates/.content.php

----------------------
Простые примеры применения шаблонов в зависимости от различных условий

Если свойство раздела phone равно Y:

$APPLICATION->GetDirProperty("phone")=="Y"


Если текущий раздел равен /ru/catalog/phone/

$APPLICATION->GetCurDir()=="/ru/catalog/phone/"


Если текущий пользователь - администратор

$USER->IsAdmin()


Если нужно привязать шаблон к динамической странице (в примере - к детальной странице(карточке) товара.)

preg_match("#/catalog/\?SECTION_ID=\d+&ELEMENT_ID=\d+#i",$_SERVER['REQUEST_URI']);


Подключение favicon.ico для разных шаблонов

Для того чтобы в разных шаблонах сайтов были разные значки, надо в шаблоне в header.php добавить вызов значка из шаблона:

<link rel="icon" type="image/x-icon" href="<?=SITE_TEMPLATE_PATH;?>/images/favicon.ico" />
----------------------

----------------------

----------------------

----------------------

----------------------

----------------------

----------------------